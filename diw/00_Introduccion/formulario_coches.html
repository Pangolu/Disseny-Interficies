<!DOCTYPE html>
<html>
<head>

<script>

    let bbddCoches= {
        "Fiat":[ "tipo", "500", "500X"] ,
        "Seat":[ "toledo", "ibiza", "cordoba", "leon" ],
        "Alfa Romeo": ["Giulietta","Giulia","Stelvio"],
        "Mercedes":["C","CLA","B","GLA","GLB"],
        "Volkswagen":["Golf","Jetta","Phenom","Polo"]
    };

    function cargarMarcas(){
        let desplegableMarcas = document.getElementById("marca");

        for (let key in bbddCoches) {
            textoHtml =
                "<option value=\"" + key+"\"> " + key +"</option>";
            console.log(textoHtml);
            desplegableMarcas.innerHTML += textoHtml;
        }
        for (let key in bbddCoches) {
            let opcion = document.createElement("option");
            opcion.value = key;
            opcion.textContent = key;
            desplegableMarcas.appendChild(opcion);

        }
    }

    function actualizarModelos(){
        /*1 averiguar la marca elegida */
        /*2 borrar tot el contigut del select modelos*/
        let desplegableModelos = document.getElementById("modelo");
        desplegableModelos.innerHTML ="";

        let desplegableMarcas = document.getElementById("marca");
        let marca = desplegableMarcas.value;

        console.log("La marca elegida es ->" + marca + "<- ");

        let modelosElegidos = bbddCoches[marca];

        console.log("Los modelos elegidos son", modelosElegidos);
        console.log("la basede datos decoches es " + bbddCoches);

        for (let i=0; i< modelosElegidos.length;i++) {
            let modelo = document.createElement("option");
            modelo.text = modelosElegidos[i];
            modelo.value = modelosElegidos[i];
            desplegableModelos.appendChild(modelo);
            }

        }

    function cambiarFoto(){
        let botonFoto = document.getElementById("fot");
        let rutaArchivo = botonFoto.files[0];

        console.log("El archivo elegido es " , rutaArchivo);

        let compImagen = document.getElementById("imagen");


        let lector = new FileReader();
        lector.readAsDataURL(rutaArchivo);

        lector.addEventListener("load", ()=>{
            console.log(lector.result);
            compImagen.src = lector.result;
        });

    }


    function inicializar() {
        cargarMarcas();

        let desplegableMarcas = document.getElementById("marca");
        desplegableMarcas.addEventListener("change", actualizarModelos);


        let botonFoto = document.getElementById("fot");
        fot.addEventListener("change",cambiarFoto);

    }

    document.addEventListener("DOMContentLoaded",inicializar);

</script>
</head>

<body>
    <form action="POST" autocomplete="on" >
    <table  border="0">
        <tbody>
          <tr>
            <td colspan="5"> <fieldset>
                <label for="marca">marca: </label>

                <!--select name="Marca" id="marca">
                     <option value="Fiat">Fiat</option>
                     <option value="Alfa Romero">Alfa Romeo</option>
                     <option value="Citroein">Citroen</option>
                     <option value="Seat">Seat</option>
                     <option value="Volkswagen">Volkswagen</option>
                     <option value="Hyundai">Hyundai</option>
                     <option value="Kia">Kia</option>
                     <option value="Toyota">Toyota</option>
                 </select-->
                 <!--Ahora rellenaod por javascript desde bbddCoches -->

				<select name="Marca" id="marca"> </select>

                 <label for="modelo">Modelo: </label>

                 <!--select id="modelo" autofocus required minlength="20"-->
                  <select id="modelo" style="width:20em;" autofocus required>
                 </select>

                 <label for="pais">Pa&iacute;s: </label>
                 <select name="Pais" id="pais">
                    <optgroup label="América"></optgroup>
                     <option value="EEUU">EEUU</option>
                     <option value="Canada">Canada</option>
                     <option value="Mexico">Mexico</option>
                    <optgroup label="Europa"></optgroup>
                     <option value="Italia">Italia</option>
                     <option value="Alemania">Alemania</option>
                    <optgroup label="Asia"></optgroup>
                     <option value="Korea">Korea</option>
                     <option value="Japon">Japon</option>
                     <option value="China">China</option>
                 </select>

            </fieldset></td>
          </tr>
          <tr>
            <td> <label for="cilindrada">Cilindrada: </label>
            <input type="text" id="cilindrada" autofocus required pattern="[0-9]{4}(cc){0,1}" ></td>
            <td> <label for="tipoMotor">Tipo de Motor: </label>
                <select name="Tipo" id="tipoMotor">
                <option value="Doce">12V</option>
                <option value="Diez">10V</option>
                <option value="ocho">8V</option>
            </select></td>
            <td><label for="Revoluciones">Revoluciones/min: </label>
                <input type="range" id="revoluciones" step="100" min="4000" max="22000"><div id="muestraRev">000</div></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td> <label for="fot">Fotografia:</label>
                <input type="file" id="fot"
                	multiple
                	accept="image/png, image/jpeg"
                ></td>
            <td>       <label for="velMax">Velocidad Maxima:</label>
                <input type="text" id="velMax" pattern="[0-9]{3}(km/h)+" placeholder="111"></td>
            <td>       <label >Combustible:</label>
                <fieldset>
                    <label for="Combustible">Combustible:</label><br>
                    <input type="radio" id="gasolina" name="combustible" value="gasolina">
                    <label for="gasolina">gasolina</label><br>
                    <input type="radio" id="diesel" name="combustible" value="diesel">
                    <label for="diesel">diesel</label><br>
                    <input type="radio" id="alcohol" name="combustible" value="alcohol">
                    <label for="alcohol">Alcohol</label>

            </fieldset></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><label for="enProducción">En produccion:</label>
                <input type="checkbox" id="enProducción"></td>
            <td><label for="codigoInterno">Codigo Interno </label>
                <input type="text" id="codigoInterno" pattern="[A-D]\d{1,2}" ></td>
            <td >
                <div id="divColor" style="background-color: bisque;">
                <label for="color">Color del coche:</label>
                <input type="color" id="color"></td>
                </div>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td><fieldset>Opciones
                <label for="direccion">Direccion Asistida:</label>
                <input type="checkbox" id="direccion" name="Direccion Asistida">

                <label for="elevalunas">Elevalunas Eléctrico:</label>
                <input type="checkbox" id="elevalunas" name="Elevalunas Electrico">

                <label for="radiocassette">RadioCassette</label>
                <input type="checkbox" id="radiocassette" name="radiocassette">


            </fieldset></td>
            <td colspan="4"><input type="submit" value="Enviar"> <input type="reset" value="Reiniciar"></td>
          </tr>
        </tbody>
        </table>
    </form>
    <img src="./imagen.jpg" id="imagen" width="800px" height="600px">
</body>
</html>
